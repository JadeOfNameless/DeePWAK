\begin{algorithm}[H]
  \label{alg:WAK}
  \caption{Weighted Affinity Kernel}
  \DontPrintSemicolon  % Don't print semicolons

  \SetKwProg{Fn}{Function}{}{end}
  \SetKwFunction{WAK}{WAK}

  \Fn{\WAK{$G$}}{
    \KwIn{$G$ : $\mathbb{R}^{n \times n}$}
    \KwOut{$W$ : $\mathbb{R}^{n \times n}$}
    \Begin{
      $G_{-I} \leftarrow G \odot (\mathbf{1} - I)$ \tcp*{set diagonal to 0}
      $\mathbf{w} \leftarrow \einsum^{ij \to j}(G_{-I})$ \tcp*{sum over columns}
      $W \leftarrow \einsum^{ij,i \to j}(G_{-I}, \mathbf{w}^{-1})$ \tcp*{scale columns to sum to 1}
      \KwRet{$W$}
    }
  }
\end{algorithm}

